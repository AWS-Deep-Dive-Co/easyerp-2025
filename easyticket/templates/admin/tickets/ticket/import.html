{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block title %}Import Tickets{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">Home</a>
    &rsaquo; <a href="{% url 'admin:app_list' app_label='tickets' %}">Tickets</a>
    &rsaquo; <a href="{% url 'admin:tickets_ticket_changelist' %}">Tickets</a>
    &rsaquo; Import
</div>
{% endblock %}

{% block content %}
<h1>Import Tickets from CSV</h1>

<div class="module aligned">
    <h2>Upload CSV File</h2>
    
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <div class="form-row">
            <div>
                <label for="csv_file">CSV File:</label>
                <input type="file" name="csv_file" id="csv_file" accept=".csv" required>
                <div class="help">
                    Upload a CSV file with ticket data. The file should have the following columns:<br>
                    <strong>Required:</strong> Title, Type<br>
                    <strong>Optional:</strong> Ticket Number, Description, Status, Priority, Requested By, Assigned To, Created By, Created At, Due Date, Business Justification, Technical Details, Risk Assessment
                </div>
            </div>
        </div>
        
        <div class="submit-row">
            <input type="submit" value="Import Tickets" class="default">
            <a href="{% url 'admin:tickets_ticket_changelist' %}" class="button cancel-link">Cancel</a>
        </div>
    </form>
</div>

<div class="module">
    <h2>CSV Format Example</h2>
    <pre>Title,Description,Type,Status,Priority,Requested By,Business Justification
"Update user permissions","Grant John Smith access to financial reports","Access Request","open","medium","Jane Doe","Employee needs access for quarterly reporting"
"Server maintenance","Schedule maintenance window for web servers","Standard Change Request","pending_approval","high","IT Operations","Critical security patches need to be applied"</pre>
</div>

<div class="module">
    <h2>Import Notes</h2>
    <ul>
        <li>If a ticket number is provided and already exists, that row will be skipped</li>
        <li>Ticket types will be created automatically if they don't exist</li>
        <li>All imported tickets will be assigned to the current user as the creator</li>
        <li>Invalid status or priority values will default to 'open' and 'medium' respectively</li>
        <li>Date fields should be in format: YYYY-MM-DD HH:MM:SS</li>
    </ul>
</div>

<style>
.help {
    font-size: 11px;
    color: #666;
    margin: 5px 0;
}
pre {
    background: #f8f8f8;
    padding: 10px;
    border: 1px solid #ddd;
    font-size: 11px;
    overflow-x: auto;
}
</style>
{% endblock %}
